<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Cheese High" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/cheeseHigh.png?v=5.0.1" />






<meta name="description" content="分享一下我在上CMU的18-600: Foundations of Computer Systems (15-213: Introduction to Computer Systems在ECE系的改编课程)时对教材”Computer Systems: A Programmer’s Perspective” (CSAPP)的读书笔记，内容按照原书章节组织，主要以重要知识点的形式呈现。
A Tour">
<meta property="og:type" content="article">
<meta property="og:title" content="CSAPP Reading Notes">
<meta property="og:url" content="http://cheesehigh.com/2016/12/31/csapp/index.html">
<meta property="og:site_name" content="Cheese High">
<meta property="og:description" content="分享一下我在上CMU的18-600: Foundations of Computer Systems (15-213: Introduction to Computer Systems在ECE系的改编课程)时对教材”Computer Systems: A Programmer’s Perspective” (CSAPP)的读书笔记，内容按照原书章节组织，主要以重要知识点的形式呈现。
A Tour">
<meta property="og:updated_time" content="2017-01-22T08:32:32.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CSAPP Reading Notes">
<meta name="twitter:description" content="分享一下我在上CMU的18-600: Foundations of Computer Systems (15-213: Introduction to Computer Systems在ECE系的改编课程)时对教材”Computer Systems: A Programmer’s Perspective” (CSAPP)的读书笔记，内容按照原书章节组织，主要以重要知识点的形式呈现。
A Tour">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: undefined,
      author: 'Author'
    }
  };
</script>

  <title> CSAPP Reading Notes | Cheese High </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Cheese High</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Cheese High</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  
  
  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                CSAPP Reading Notes
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-12-31T00:04:44+08:00" content="2016-12-31">
              2016-12-31
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Tech/" itemprop="url" rel="index">
                    <span itemprop="name">Tech</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/12/31/csapp/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/31/csapp/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          

    <span id="busuanzi_container_page_pv">  |  阅读量 <span id="busuanzi_value_page_pv"></span> 次</span>


        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>分享一下我在上CMU的18-600: Foundations of Computer Systems (15-213: Introduction to Computer Systems在ECE系的改编课程)时对教材”Computer Systems: A Programmer’s Perspective” (CSAPP)的读书笔记，内容按照原书章节组织，主要以重要知识点的形式呈现。</p>
<h3 id="A-Tour-of-Computer-Systems"><a href="#A-Tour-of-Computer-Systems" class="headerlink" title="A Tour of Computer Systems"></a>A Tour of Computer Systems</h3><ul>
<li>Information = bits + context</li>
<li>Compilation system<ul>
<li>Pre-processor: add head file to source file, program.i</li>
<li>Compilation: translate source file into assembly language, program.s</li>
<li>Assembly: translate assembly language into relocatable object file, program.o</li>
<li>Linking: link all relocatable object program to executable object file, program</li>
</ul>
</li>
<li>GNU provides environment tools for Linux</li>
<li>Virtual Memory(virtual address space): program-runtime heap-shared libraries-stack-kernel</li>
<li>multiprocessor: multi-cores + hyperthread</li>
</ul>
<h3 id="Representing-and-Manipulating-Information"><a href="#Representing-and-Manipulating-Information" class="headerlink" title="Representing and Manipulating Information"></a>Representing and Manipulating Information</h3><ul>
<li>little endian: less significant bytes in low address; big endian: more significant bytes in low address</li>
<li>typedef unsigned char *byte_pointer: type alias</li>
<li>Bit Operation: ~ NOT; ^ Exclusive OR</li>
<li>Logic Operation(&amp;&amp;, ||, !): Any non-zero parameter = 1</li>
<li>Sign bit =-2^w-1</li>
<li>Signed &lt;-&gt; Unsigned: Bit pattern do not change, +/- 2^w</li>
<li>Signed mixed with unsigned: signed -&gt; unsigned</li>
<li>Pay attention to Tmin and 0</li>
<li>Java only supports signed integer</li>
<li>Two’s Complement = Signed = 补码; Addition = Bit addition + truncating</li>
<li>Multiplication is costly, use shift + addition/substraction</li>
<li>Unsigned Division: right logic shift; Two’s Complement Division: right arithmetic shift</li>
<li>IEEE floating point = (-1)^s <em> M(frac) </em> 2^E(exp), need approximation and round</li>
<li>Normalized: exp != all 0 &amp;&amp; exp !=all 1: E = exp - bias(2^k-1 - 1); M = 1 + .frac;</li>
<li>Denormalized: exp == all 0: E = 1- bias; M = .frac;</li>
<li>Special value: exp == all 1: Inf(frac = all 0, should be set to 0); NaN(frac != 0)</li>
<li>In the half, round to even</li>
<li>unsigned int a = 15213U;</li>
<li>long: 4 Bytes(32 bit); 8 Bytes(64 bit)</li>
<li>size_t: unsigned int(32 bit); long unsigned int(64 bit)</li>
</ul>
<h3 id="Machine-Level-Representation-of-Programs"><a href="#Machine-Level-Representation-of-Programs" class="headerlink" title="Machine-Level Representation of Programs"></a>Machine-Level Representation of Programs</h3><ul>
<li>gcc -O1(optimization level) -g(source code line) -o(compile stage) p p1.c p2.c</li>
<li>objdump -d program.o: disassembler generate assembly code from object code</li>
<li>Assembly Language: AT&amp;T Format(-&gt;) V.S. Intel Format(&lt;-)</li>
<li>byte(b): 8 bits; word(w): 16 bits; long word(l): 32 bits; quad word(q): 64 bits</li>
<li>Register: %rax(64)-%eax(32)-%ax(16)-%ah(15-8)-%al(7-0)</li>
<li>ax, cx, dx(caller-save); bx, si, di(callee-save): generally purpose; sp: stack pointer; bp: frame pointer</li>
<li>$immediate, %Register, disp(base, index*scale)</li>
<li>SUB src, dst: dst - src -&gt; dst</li>
<li>64-bit Multiply: imull src: src * %eax -&gt; %edx:%eax</li>
<li>64-bit Divide: idivl src: %edx:%eax / src -&gt; %eax, %edx:%eax mod src -&gt; %edx</li>
<li>cltd: %eax -&gt; %edx:%eax</li>
<li>SAL(Arithmetic Left); SHL(Logical Left); SAR(Arithmetic Right); SHR(Logical Right)</li>
<li>condition codes: ZF(zero); SF(negative); OF(signed overflow); CF(unsigned overflow)</li>
<li>cmp s2,s1: s1-s2(set condition codes then); set dst; jmp label/*address; signed(g/l); unsigned(a/b)</li>
<li>if-else: jmp label; loop: label; jmp label; switch: jump table contains address</li>
<li>conditional expression: cmov, conditional move, compute all first, better performance than conditional control for pipeline misprediction</li>
<li>procedure(stack frame): (caller)local var, params, return addr, (callee)bp(higher), local var, sp(lower)</li>
<li>Array: contiguous memory, address +/- with data type</li>
<li>Union: Store one field at a time, referenced by data type</li>
<li>Alignment: data address must be multiple of its size</li>
<li>x86-64: IA64-AMD64-Intel64: six parameters by ordered register(di,si,dx,cx,r8,r9), no %bp</li>
<li>Buffer overflow attack: strcpy to inject instructions and change return address</li>
<li>struct member address must align</li>
</ul>
<h3 id="Processor-Architecture"><a href="#Processor-Architecture" class="headerlink" title="Processor Architecture"></a>Processor Architecture</h3><ul>
<li>Y86: Balance between CISC and RISC</li>
<li>F: No register</li>
<li>HCL(Hardware Control Language): Describe control logic circuit</li>
<li>bool out = f(logic operator);</li>
<li>multiplexor(output one of the inputs): int out = [s in {I}:A; 1:B];</li>
<li>clocked registers: state = output, update when clock rise</li>
<li>random-access memories: given address, register file</li>
<li>SEQ(Sequential) Processor: Serve one instruction until it finishes</li>
<li>Instruction stage: fetch-decode-execute-memory-write back(register)-PC update</li>
<li>Every instruction uses one clock cycle. As clock rises, state elements(PC, CC, register file, RAM) updated according to the previous instruction. In the clock cycle, combinational logic propagate to create new value for state elements updated in next clock rise</li>
<li>Slow: Each hardware unit is only active for a fraction of the clock cycle</li>
<li>Pipelined Processor: One instruction finished this stage will move on to next, next instruction will come</li>
<li>throughput = 1 / clock period(stage + pipeline register)</li>
<li>The former instruction move on, the address of next instruction(new PC) must be predicted</li>
<li>instruction dependency hazard(data + control): stalling + forwarding + both(load interlock)</li>
<li>SEQ+: move PC update to the beginning</li>
<li>PIPE-: insert pipeline regisger(before the corresponding stage)</li>
<li>PIPE: forward logic in decode stage</li>
<li>Exception Handling: stat field in pipeline register</li>
<li>CPI = 1 + Cbubble/Cinstuction = 1 + load/use + mispredict + ret</li>
<li>SSE: Streaming SIMD Extensions; x86-64 floating point registers: %xmm0-%xmm15 can hold multiple values</li>
<li>SuperScalar: Instruction Per Cycle &gt; 1; Out of Order</li>
<li>Branch Target Buffer for dynamic branch prediction: previous instruction addr -&gt; target addr</li>
<li>Register Rename: small architecture regs -&gt; large physical regs, ARF -&gt; RRF</li>
<li>Load Bypassing: load ahead of store; Load Forwarding: forward store to load</li>
</ul>
<h3 id="Optimizing-Program-Performance"><a href="#Optimizing-Program-Performance" class="headerlink" title="Optimizing Program Performance"></a>Optimizing Program Performance</h3><ul>
<li>Criteria</li>
</ul>
<ol>
<li>Correctness</li>
<li>Readability </li>
<li>Performance</li>
</ol>
<ul>
<li>Trade-off between readability and performance</li>
<li>Method</li>
</ul>
<ol>
<li>High-level design: efficient algorithm and data structure</li>
<li>Basic coding principles: easy for compiler to optimize</li>
<li>Low-level optimizations</li>
</ol>
<ul>
<li>Memory Aliasing: two pointers are designated to the same memory location</li>
<li>Cycles Per Element(CPE): measure program performance</li>
<li>Move unnecessary code out of loop</li>
<li>Reduce function calls</li>
<li>Eliminate unnecessary memory reference</li>
<li>latency: cycles to perform operation; issue time: cycles between operations</li>
<li>Loop Unrolling: Reduce iteration and loop operation</li>
<li>Use more local accumulators and reassociation transformation to enhance parallelism</li>
<li>Use conditional move to avoid branch misprediction</li>
<li>Parallel memory load and store</li>
<li>Program Profiling: gprof</li>
<li>Amdahl’s Law: speedup = 1 / (1 - alpha + alpha / k)</li>
<li>To significantly speed up the entire system, we must improve the speed of a very large fraction of the overall system</li>
<li>Significant speedup lies in 90% - 100%</li>
</ul>
<h3 id="The-Memory-Hierarchy"><a href="#The-Memory-Hierarchy" class="headerlink" title="The Memory Hierarchy"></a>The Memory Hierarchy</h3><ul>
<li>Register -&gt; N-level Cache -&gt; Main Memory -&gt; Local Disk -&gt; Remote Disk</li>
<li>RAM: available when power on</li>
<li>one bit = one cell</li>
<li>SRAM(Static): Cache; bistable, 6 transistors per bit</li>
<li>DRAM(Dynamic): Main Memory; Sensitive, 1 transistor per bit</li>
<li>Memory controller with addr and data pins</li>
<li>Main Memory -&gt; Memory Modules -&gt; DRAM Chips -&gt; Supercells(row,column) -&gt; 8 cells(1 byte) </li>
<li>SDRAM: Synchronous DRAM, replace memory control with clock rise</li>
<li>DDR(Double Data Rate): Double control signal and increase buffer</li>
<li>ROM: nonvolatile when power off, limited erase time</li>
<li>EEPROM(Electrically Erasable Programmable ROM): Flash Memory, Solid State Disk</li>
<li>CPU - Bus Interface - System Bus - I/O Bridge - Memory Bus - Main Memory<br>I/O Bridge - I/O Bus(Peripheral Component Interconnect)</li>
<li>Universal Serial Bus(SSD), Host Bus Adaptor(SCSI, SATA)</li>
<li>sector + gap -&gt; track -&gt; cylinder &lt;=&gt; Logic Block</li>
<li>RPM: Revolutions Per Minute</li>
<li>Access Time = avg seek time + avg rotation latency + avg transfer time</li>
<li>Temporal Locality: reference itself; Spatial Locality: reference nearby location</li>
<li>Cache: S sets -&gt; E lines -&gt; 1 valid bit + t tag bits + B bytes block; C= BES</li>
<li>Memory Address: t bits tag + s bits set index + b bits block offset</li>
<li>Direct Mapped Cache(E=1); E-way Set Associative Cache(1&lt;E&lt;ES); Fully Associative Cache(S=1)</li>
<li>(valid == 1 &amp;&amp; tag match) ? hit : miss;</li>
<li>Miss: Fetch entire block from memory to cache line</li>
<li>Cold Miss, Conflict Miss, Capacity Miss</li>
<li>Memory Mountain: read throughput = f(size(temporal locality),stride(spatial locality))</li>
</ul>
<h3 id="Linking"><a href="#Linking" class="headerlink" title="Linking"></a>Linking</h3><ul>
<li>Collect and combine code and data into a single file that can be loaded into memory and executed</li>
<li>Linker enables separate complition, link at (static linker)compile time, (dynamic linker)load time, run time</li>
<li>Symbol resolution</li>
<li>Symbol: variables + functions</li>
<li>static: local symbol; nonstatic: global symbol defined by self; external: global symbol defined by others</li>
<li>strong symbol: initialized global variable and function; weak symbol: uninitialized global variable</li>
<li>strong with strong: link error; strong with weak: pick strong; weak with weak: pick any one</li>
<li>static library: lib.a(archive), only copy the object modules that are referenced</li>
<li>E: object file; U: undefined symbol; D: defined symbol</li>
<li>scan object file and static library in order and update E, U, D</li>
<li>Referenced file should after file that reference it</li>
<li>Relocation: section merge + relocate symbol reference within section</li>
<li>Load executable object file: copying the program into memory and then running</li>
<li>Shared library: dynamic link at run time, lib.so</li>
<li>dynamic link in program: handle = dlopen(lib.so); func = dlsym(handle,”func”); dlclose(handle)</li>
<li>Position Independent Code: distance between code segment and data segment is constant</li>
<li>Global Offset Table + Procedure Linkage Table</li>
</ul>
<h3 id="Exceptional-Control-Flow"><a href="#Exceptional-Control-Flow" class="headerlink" title="Exceptional Control Flow"></a>Exceptional Control Flow</h3><ul>
<li>Control Flow: Sequence of control transfer</li>
<li>Sychronous: Call return only if it finished; Asynchronous: Call return immediately and notify later if finish</li>
<li>Exception: OS and hardware(low-level), interrupt(I/O device, Processor issue to OS), trap, fault, abort</li>
<li>Event occur -&gt; exception -&gt; exception table -&gt; exception handler(kernel mode) -&gt; return/abort</li>
<li>System Call(trap, 0x80 in exception table): syscall, Application call OS<br>Fault(might recoverable)</li>
<li>Floating Exception: Divide by 0; Segmentation Fault: Access undefined address and write read-only file</li>
<li>Program: a collection of code and data</li>
<li>Process: Instance of a program in execution, illusion that has exclusive use of processor and memory</li>
<li>Process need context switching when exception occur, threads are in the same context</li>
<li>3 states of process: Running, Stopped, Terminated</li>
<li>fork(): parent -&gt; child, return child pid to parent and 0 to child, parent reap its terminated child(zombie)</li>
<li>pid waitpid(pid,status,option): waits children to terminate or stop and reap them</li>
<li>execve(filename,argv,envp): loads and runs a new program in the context of the current process</li>
<li>fork: new process, same program; execve: same process, new program</li>
<li>Signal: Application and OS(high-level), kernel notify process that event occur</li>
<li>block(can be deliver until unblock) - pending(only one for one type) - receive</li>
<li>process group: -PID</li>
<li>signal(signum,handler): install user-defined handler for handling received signal</li>
<li>Nonlocal jumps: jump to other function, setjmp(like catch) + longjmp(return setjmp, like throw)</li>
</ul>
<h3 id="Virtual-Memory"><a href="#Virtual-Memory" class="headerlink" title="Virtual Memory"></a>Virtual Memory</h3><ul>
<li>Physical Addressing(PA): 0~M-1, m bits; Virtual Addressing(VA): 0~N-1, n bits<br>Memory Management Unit(MMU) translate VA to PA</li>
<li>Cache Transfer Unit: page, block</li>
<li>Each process have its own virtual adress space and page table</li>
<li>Virtual Memory: Array of N contiguous byte-sized cells stored on disk</li>
<li>Unallocated(no space on disk), Cached(fully associative in physical memory), Uncached(on disk)</li>
<li>Page Table Base Register -&gt; Page Table(in cache or memory): each entry map VP to PP</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">Virtual Page(VP)</th>
<th style="text-align:center">valid</th>
<th style="text-align:center">Physical Page(PP)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">        0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">physical address(cached), page hit</td>
</tr>
<tr>
<td style="text-align:center">        1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">disk address(uncached), page fault, swap/page in/out and execute again</td>
</tr>
<tr>
<td style="text-align:center">        2</td>
<td style="text-align:center">0</td>
<td style="text-align:center">null(unallocated)</td>
</tr>
</tbody>
</table>
<ul>
<li>Demand Paging: the strategy of waiting until the last moment to swap in a page, when a miss occurs</li>
<li>Virtual Page Number -&gt; Page Table Entry -&gt; Physical Page Number</li>
<li>Virtual Page Offset = Physical Page Offset</li>
<li>Translation Lookaside Buffer: cache of page table(SRAM and DRAM) in MMU</li>
<li>Multi-level page tables: bits of (page amount) are separated into multiple sections</li>
<li>m*n PTEs are organized as m PTEs(level 1), n PTEs(level2) for each level 1 PTE, level 2 n PTEs doesn’t exist if corresponding level 1 PTE is null</li>
</ul>
<ol>
<li>VA -&gt;PA<br>hit: VPN -&gt; MMU(TLB) -&gt; PPN<br>miss: VPN -&gt; multi-level page table -&gt; PPN</li>
<li>Get data word<br>PA -&gt; Cache -&gt; Physical Memory</li>
</ol>
<ul>
<li>Linux Virtual Memory: vm_area_structs -&gt; different sections of process virtual memory</li>
<li>Memory Mapping: initialize virtual memory area by associating it with an object(shared, private copy-on-write, anonymous) on disk</li>
<li>mmap: create a new virtual memory area which mapped to a object; munmap: delete the area</li>
<li>brk: top of the heap; payload: actual requested size; bp: block pointer, the first word after header</li>
<li>void *sbrk(intptr_t incr); // set brk to grow or shrink the heap</li>
<li>void *malloc(size_t size); // allocate one size space, return null on error, not initialized</li>
<li>Notice Allocate Alignment!</li>
<li>void *calloc(size_t numElements, size_t sizeOfElement); // allocate initialized spaces </li>
<li>void <em>realloc(void </em>ptr, size_t newsize); // reallocate ptr with one newsize space, might in new location</li>
<li>void free(void* ptr); //explicitly free allocated block</li>
<li>Goal: maximize throughput(request number), maximize memory utilization(peak utilization)</li>
<li>internal fragmentation: allocated block &gt; request; external fragmentation: every free block &lt; request</li>
<li>boundary tags: copy header to footer, current block just check one previous word</li>
<li>implicit free list: start + 2 prologue + heap blocks(header + payload + padding + footer) + epilogue</li>
<li>placement, splitting, coalescing(false fragmentation, combine free blocks)</li>
<li>explicit free list: doubly linked free list; segregated free list: multiple free lists of different size</li>
<li>buddy system: segregated free list of sizes of power of two</li>
<li>new/delete: C++ operator, allocate/free self-defined object, do construction构造 &amp; deconstruction析构</li>
<li>Garbage Collection: implicitly free allocated block, directed graph(root nodes -&gt; heap nodes)</li>
<li>garbage: unreachable nodes which will never be used again</li>
<li>Mark&amp;Sweep: mark reachable blocks and sweep unmarked allocated blocks</li>
</ul>
<h3 id="System-Level-I-O"><a href="#System-Level-I-O" class="headerlink" title="System-Level I/O"></a>System-Level I/O</h3><ul>
<li>I/O: copy data between main memory and external device(disk drive, terminal, networks: file)</li>
<li>open/close file<ul>
<li>int open(filename,flags,mode); return file descriptor(fd); int close(fd);</li>
<li>unix shell begin with three descriptor: stdin, stdout, stderr</li>
</ul>
</li>
<li>read/write file<ul>
<li>read(fd,buf,size); write(fd,buf,size);</li>
<li>RIO(Robust I/O) for handling short counts(fewer bytes than request, EOF, text line, network delay)</li>
</ul>
</li>
<li>unbuffered for network delay; buffered for text line</li>
<li>buffer in memory can improve efficiency: interact with buffer directly rather than use system call every time to r/w some small bytes, buffer interact with file by buffersize at a time</li>
<li>change file position</li>
<li>file metadata: stat(filename,buf);</li>
<li>open file data structure<ul>
<li>descriptor table(unique for process) -&gt; open file table(file pos) -&gt; v-node table(file)(shared by process)</li>
</ul>
</li>
<li>I/O Redirection: int dup2(oldfd,newfd), copy descriptor table entry of oldfd to newfd</li>
<li>C Standard I/O, RIO(higher-level) - Unix I/O(lower-level, for network)</li>
</ul>
<h3 id="Network-Programming"><a href="#Network-Programming" class="headerlink" title="Network Programming"></a>Network Programming</h3><ul>
<li>client-server transaction: client process request server process, server process response client process</li>
<li>TCP/IP Protocol Stack: Application Layer - Transport Layer - Internet Layer - Network Access Layer</li>
<li>LAN: Bridged Ethernet(Host - Hub(copy every bit to every other port) - Bridge(selectively copy frame to dest))</li>
<li>internet: LAN - router(connect incompatible LANs); Global IP Internet: one implementation of internet</li>
<li>Reliable Transfer: no transfer error including lost, duplicate and wrong order</li>
<li>TCP(Transmission Control Protocol)/UDP(Unreliable Datagram Protocol): process to process</li>
<li>Three-way Handshake: SYN -&gt; SYN+ACK -&gt; ACK</li>
<li>IP(Internet Protocol): host to host(send datagrams, unreliable)</li>
<li>MAC Address: 48 bit; IP Address: 32 bit(ipv6: 16 Bytes), dotted-decimal notation; Network Byte Order: big-endian</li>
<li>unnamed root -&gt; first-level domain name(com) -&gt; second-level domain name(google) -&gt; third-level domain name(www)</li>
<li>Socket: end point of connection, IP address:port(16 bit); ephemeral port, well-known port</li>
<li>Socket Interface<ul>
<li>Client: open_clientfd(socket - connect) - I/O - close; Server: open_listenfd(socket - bind - listen) - accept - I/O - close</li>
<li>client blocks in connect, server blocks in accept</li>
<li>listening descriptor exist for lifetime of server(open_listenfd); connected descriptor exist during the connection(accept)</li>
</ul>
</li>
<li>World Wide Web is a service provided by Internet using HTTP(Hypertext Transfer Protocol)</li>
<li>MIME: Multipurpose Internet Mail Extensions</li>
<li>URI(Uniform Resource Identifier) = URL(locater) + URN(name)</li>
<li>HTTP Request Line: method URI version; HTTP Response Line: version status code status message</li>
<li>status code: 200(OK), 301(permanently redirect), 302(temporarily redirect), 403(Forbidden), 404(Not found)</li>
<li>CGI(Common Gateway Interface): interface with executable programs on a server that generate web pages dynamically</li>
<li>Proxy: bypass firewall, page translation, anonymizer, cache</li>
</ul>
<h3 id="Concurrent-Programming"><a href="#Concurrent-Programming" class="headerlink" title="Concurrent Programming"></a>Concurrent Programming</h3><ul>
<li>Processes<ul>
<li>parent forks a child to handle each new connection request, child closes listenfd, parent closes connfd</li>
<li>Interprocess Communication(IPC)</li>
<li>Pros: having separate virtual address space; Cons: difficult to share state information, high overhead</li>
</ul>
</li>
<li>I/O Multiplexing<ul>
<li>select function blocks until one of the descriptors in the read set is ready to read</li>
<li>state machine: (input state, input event) -&gt; output state</li>
<li>Pros: more control, share state information; Cons: complexity</li>
</ul>
</li>
<li>Threads(hybrid of Process and I/O Multiplexing)<ul>
<li>Like processes, threads are scheduled automatically by the kernel and are known to the kernel by an integer ID. Like I/O multiplexing, multiple threads run in the context of a single process, and thus share the entire contents of the process virtual address space, including its code, data, heap, shared libraries, and open files. Each thread has its own thread context(thread ID(TID), stack, stack pointer, program counter, general-purpose registers, condition codes)</li>
</ul>
</li>
<li>main thread(the first thread) </li>
<li>peer threads: thread can kill any of its peers or wait for any of its peers to terminate.</li>
<li>POSIX Thread: pthread, pthread_t tid</li>
<li>joinable thread(default): reaped and killed by other threads and memory resources are not freed until it is reaped by another thread; detached thread(prefer): cannot be reaped or killed by other threads and memory resources are freed automatically by the system when it terminates.</li>
<li>Global variables: one instance in virtual address space and can be referenced by any thread</li>
<li>Local automatic variables: each thread’s stack contains its own instances and can also be shared though</li>
<li>Local static variables: one instance in virtual address space and can be referenced by any thread</li>
<li>Thread safe: manipulate shared data structures by multiple threads and guarantee safe execution and correct result </li>
<li>Thread synchronization: coordinate threads to access critical section</li>
<li>Semaphore: solution to synchronization, a nonnegative global variable s</li>
<li>P(s): decrement s if s is nonzero, block if s is zero until V(s); V(s): increment s, restart one P(s) if s becomes nonzero</li>
<li>P and V cannot be interrupted: atomic operation</li>
<li>Mutual Exclusion: initialize s with 1; P(s); Do(); V(s); Only can execute Do() with THE ONE s(mutex), like talking pillow</li>
<li>Producer-Consumer Problem: Producer: P(slot)-P(mutex)-insert-V(mutex)-V(item); Consumer: P(item)-P(mutex)-remove-V(mutex)-V(slot)</li>
<li>Readers-Writers Problem: reader-favored(reader can read although writer is waiting); writer-favored(writer write as soon as possible after the previous readers finish)</li>
<li>Reader: P(mutex); readcnt++; if(readcnt == 1) {P(w);} V(mutex); Read(); P(mutex); readcnt–; if(readcnt == 0) {V(w);} V(mutex); Writer: P(w); Write(); V(w);</li>
<li>Parallel programs are often written so that each core runs exactly one thread(cat /proc/cpuinfo)</li>
<li>Reentrant function(subset of thread-safe function): do not reference any shared data</li>
<li>Deadlock: each thread is waiting for the other to do V that will never occur, because of wrong order of P and V</li>
</ul>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/07/07/peace/" rel="next" title="World Peace">
                <i class="fa fa-chevron-left"></i> World Peace
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/12/31/linux/" rel="prev" title="《鸟哥的Linux私房菜》 Reading Notes">
                《鸟哥的Linux私房菜》 Reading Notes <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


            </div>
            <% if (page.comments){ %>
<section id="comment">
  <% if(config.disqus_shortname) { %>
  <div id="disqus_thread">
  <script>
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://EXAMPLE.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
  </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  <% } %>
</section>
<% } %>
        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://o86az1gay.bkt.clouddn.com/cheeseHigh.png"
               alt="CheeseHigh" />
          <p class="site-author-name" itemprop="name">CheeseHigh</p>
          <p class="site-description motion-element" itemprop="description">White Hat/History</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">10</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/IanHua" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.instagram.com/ian_hua/" target="_blank" title="Instagram">
                  
                    <i class="fa fa-fw fa-instagram"></i>
                  
                  Instagram
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#A-Tour-of-Computer-Systems"><span class="nav-number">1.</span> <span class="nav-text">A Tour of Computer Systems</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Representing-and-Manipulating-Information"><span class="nav-number">2.</span> <span class="nav-text">Representing and Manipulating Information</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Machine-Level-Representation-of-Programs"><span class="nav-number">3.</span> <span class="nav-text">Machine-Level Representation of Programs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Processor-Architecture"><span class="nav-number">4.</span> <span class="nav-text">Processor Architecture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Optimizing-Program-Performance"><span class="nav-number">5.</span> <span class="nav-text">Optimizing Program Performance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Memory-Hierarchy"><span class="nav-number">6.</span> <span class="nav-text">The Memory Hierarchy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Linking"><span class="nav-number">7.</span> <span class="nav-text">Linking</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exceptional-Control-Flow"><span class="nav-number">8.</span> <span class="nav-text">Exceptional Control Flow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Virtual-Memory"><span class="nav-number">9.</span> <span class="nav-text">Virtual Memory</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#System-Level-I-O"><span class="nav-number">10.</span> <span class="nav-text">System-Level I/O</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Network-Programming"><span class="nav-number">11.</span> <span class="nav-text">Network Programming</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Concurrent-Programming"><span class="nav-number">12.</span> <span class="nav-text">Concurrent Programming</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheeseHigh</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<span id="busuanzi_container_site_pv">
  &nbsp; | &nbsp; 本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>

<span id="busuanzi_container_site_uv">
  &nbsp; | &nbsp; 本站访客数<span id="busuanzi_value_site_uv"></span>人次
</span>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'cheesehigh';
      var disqus_identifier = '2016/12/31/csapp/';
      var disqus_title = "CSAPP Reading Notes";
      var disqus_url = 'http://cheesehigh.com/2016/12/31/csapp/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  




  
  
  

  

  

  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</body>
</html>
